# kopi 要件定義 v1.3

## ✅ 1. 目的
- **kopi**は、一般顧客が複数の店舗から好みのドリンクを選び、事前に注文・決済を行い、店舗で待たずに受け取ることができるアプリです。
- 店舗スタッフはリアルタイムで注文を受信・管理し、効率的に提供できるようになります。

## ✅ 2. 想定ユーザー
1. **一般顧客**
   - アカウントレス（ログイン不要）
   - アプリ内で複数店舗のメニューを閲覧し、カスタマイズして注文・決済
   - 注文履歴・ステータス確認
   - 受取時にニックネームを用いて注文を識別

2. **店舗スタッフ**
   - 店舗アカウントでログイン
   - オーダー管理・提供処理・店舗設定管理
   - プッシュ通知は自動送信

## ✅ 3. 機能要件

### 🟢 ユーザーアプリ（kopi ユーザーアプリ）機能

#### 🎯 店舗・メニュー探索
- 店舗一覧表示（店舗名、住所、営業時間、営業状況）
- 店舗詳細画面（営業日カレンダー、アクセス方法）
- メニュー一覧表示（画像、商品名、価格、説明）
- 商品詳細画面（カスタマイズオプション：サイズ、氷、甘さなど ※店舗ごとに定義可能）

#### 🎯 注文
- カート管理（追加、編集、削除）
- クーポン適用
- 注文確定（店舗・商品・カスタマイズ・受取時間選択）
- 決済（クレジットカードのみ）
- 注文時にニックネームを入力し、店舗側に伝達

#### 🎯 ステータス管理
- 注文状況表示（受付済 → 調理中 → 準備完了 → 受取済）
- プッシュ通知
  - 注文受付
  - 調理開始
  - 準備完了
  - 受取忘れリマインド
  - マーケティング通知（新商品、キャンペーン）

#### 🎯 履歴
- 注文履歴一覧
- 注文詳細（日時、商品、金額、クーポン利用）

### 🟢 店舗アプリ（kopi 店舗アプリ）機能

#### 🎯 ログイン・アカウント管理
- 店舗スタッフアカウントによるログイン
- 店舗情報編集（店舗名、住所、営業時間、休業日）

#### 🎯 営業管理
- 営業開始／営業終了（オーダー受付制御）
- 緊急休業モード切り替え

#### 🎯 注文管理
- 注文一覧表示（ステータス別フィルタ、受取時間順）
- 注文詳細表示（商品名、カスタマイズ内容、備考、ニックネーム）
- ステータス更新（受付 → 調理中 → 準備完了 → 受取済）

#### 🎯 メニュー管理
- メニュー一覧表示
- 新規メニュー作成（商品名、画像、説明、価格、カテゴリ、カスタマイズオプション）
- メニュー編集／削除
- カスタマイズオプションの項目追加・削除・選択肢編集（店舗ごとに定義可能）

#### 🎯 通知
- ステータス変更に応じた自動プッシュ通知送信

## ✅ 4. 非機能要件

### 🟢 複数店舗管理
- 営業時間、メニュー、カスタマイズ、スタッフは店舗ごとに独立管理

### 🟢 アカウント仕様
- ユーザー側：ログインなし（端末内ローカルIDで履歴管理）
- 店舗側：ID／パスワードによるログイン

### 🟢 決済
- アプリ内決済必須（クレジットカードのみ）
- 領収書はアプリ内履歴画面で確認可能

## ✅ 5. プッシュ通知の実装について

React Nativeとの親和性が高いプッシュ通知ライブラリ候補：

### 🔹 React Native Firebase（@react-native-firebase/messaging）
- Firebase Cloud Messaging（FCM）を利用
- iOS／Android両対応
- フォアグラウンド、バックグラウンド、終了状態でも通知処理可能
- トピック／ユーザーごとの通知管理が容易
- [React Native Firebase Messaging Documentation](https://rnfirebase.io/messaging/usage)

### 🔹 Notifee
- 高度なカスタマイズ通知に対応
- ローカル通知やアクション付き通知をサポート
- React Native Firebaseと併用推奨
- [Notifee Documentation](https://notifee.app/react-native/docs/overview)

**推奨構成：**
- 通知の送受信：React Native Firebase
- 通知の表示／カスタマイズ：Notifee
